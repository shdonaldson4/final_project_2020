fill = "Gender")
# descrptives plot
ggplot(anova_desc_o, aes(x = country, y = mean_o, fill = gender)) +
theme_bw() +
geom_bar(position = "dodge", stat = "identity", color="black") +
geom_errorbar(
aes(ymin = mean_o - sd_o, ymax = mean_o+sd_o),
width=0.2, alpha = 0.7,
position = position_dodge(.9)) +
scale_x_discrete(labels = c("Great Britain", "India")) +
ggtitle("Average Openness Scores by Country and Gender") +
labs(x = "Country",
y = "Mean Openness Scores",
fill = "Gender")
anovaR <- aov(O ~ country + gender, data = anova_data_wide)
summary(anovaR)
anovaR <- aov(O ~ country + gender + gender*country, data = anova_data_wide)
summary(anovaR)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
mutate(country = as.factor(country)) %>%
filter(country == "GB" | country == "IN", age >=18 & age <= 80 ) %>%  #Use ONLY Great Britain and India cases, and age between 18 and 80 years
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(age,country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(age,country,gender, E, O)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
mutate(country = as.factor(country)) %>%
filter(country == "GB" | country == "IN", age >=18 & age <= 80 ) %>%  #Use ONLY Great Britain and India cases, and age between 18 and 80 years
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(age,country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(age,country,gender, E, O)
anova_desc_o <- anova_data_wide %>%
group_by(country,gender) %>%
summarize(mean_o = mean(O), sd_o = sd(O))
anova_desc_o
anovaR <- aov(O ~ country + gender + gender*country, data = anova_data_wide)
summary(anovaR)
ggplot(anova_data_wide, aes(x = country, y = O, color = gender)) +
geom_boxplot() +
theme_minimal() +
labs(title = "Comparison of Openness across Genders between The Great Britain and India",
x = "country",
y = "Openness to Experience")
# figures
interaction.plot(x.factor = anova_data_wide$country,
trace.factor = anova_data_wide$gender,
response = anova_data_wide$O, fun = mean,
type = "b", legend = TRUE,
xlab = "Country", ylab="Openness",
pch=c(1,19), col = c("#00AFBB", "#E7B800"))
# figures
interaction.plot(x.factor = anova_desc_o$country,
trace.factor = anova_desc_o$gender,
response = anova_data_wide$O, fun = mean,
type = "b", legend = TRUE,
xlab = "Country", ylab="Openness",
pch=c(1,19), col = c("#00AFBB", "#E7B800"))
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
mutate(country = as.factor(country)) %>%
filter(country == "GB" | country == "IN", age >=18 & age <= 80 ) %>%  #Use ONLY Great Britain and India cases, and age between 18 and 80 years
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(age,country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(age,country,gender, E, O)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
mutate(country = as.factor(country)) %>%
filter(country == "GB" | country == "IN", age >=18 & age <= 80)  #Use ONLY Great Britain and India cases, and age between 18 and 80 years
levels(anova_data_wide$country)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
mutate(country = as.factor(country)) %>%
filter(country == 'GB' | country == 'IN', age >=18 & age <= 80)  #Use ONLY Great Britain and India cases, and age between 18 and 80 years
levels(anova_data_wide$country)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
mutate(country = as.factor(country)) %>%
filter(name %in% c("GB", "IN"), age >=18 & age <= 80)  #Use ONLY Great Britain and India cases, and age between 18 and 80 years
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
mutate(country = as.factor(country)) %>%
filter(country %in% c("GB", "IN"), age >=18 & age <= 80)  #Use ONLY Great Britain and India cases, and age between 18 and 80 years
levels(anova_data_wide$country)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
filter(country %in% c("GB", "IN"), age >=18 & age <= 80) %>%   #Use ONLY Great Britain and India cases, and age between 18 and 80 years
mutate(country = as.factor(country))
levels(anova_data_wide$country)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
filter(country %in% c("GB", "IN"), age >=18 & age <= 80) %>%   #Use ONLY Great Britain and India cases, and age between 18 and 80 years
mutate(country = as.factor(country)) %>%
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(age,country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(age,country,gender, E, O)
anova_desc_o <- anova_data_wide %>%
group_by(country,gender) %>%
summarize(mean_o = mean(O), sd_o = sd(O))
anova_desc_o
# descrptives plot
ggplot(anova_desc_o, aes(x = country, y = mean_o, fill = gender)) +
theme_bw() +
geom_bar(position = "dodge", stat = "identity", color="black") +
geom_errorbar(
aes(ymin = mean_o - sd_o, ymax = mean_o+sd_o),
width=0.2, alpha = 0.7,
position = position_dodge(.9)) +
scale_x_discrete(labels = c("Great Britain", "India")) +
ggtitle("Average Openness Scores by Country and Gender") +
labs(x = "Country",
y = "Mean Openness Scores",
fill = "Gender")
anovaR <- aov(O ~ country + gender + gender*country, data = anova_data_wide)
summary(anovaR)
# figures
library(ggpubr)
ggline(anova_data_wide, x = "country", y = "0", color = "gender")
# figures
library(ggpubr)
ggline(anova_data_wide, x = "country", y = "O", color = "gender")
ggline(anova_data_wide, x = "country", y = "O")
# figures
library(ggpubr)
ggline(anova_data_wide, x = "country", y = "O")
View(anova_data_wide)
View(anova_data_wide)
# figures
anova_data_wide %>% group_by(country, gender) %>%
summarise_all(funs(mean(., na.rm = T),sd(., na.rm = T),n()))
library(ggpubr)
# figures
plot2WayANOVA(O ~ country * gender,
anova_data_wide,
plottype = "line",
overlay.type = "box",
mean.label = TRUE
)
# figures
library(ggplot2)
plot2WayANOVA(O ~ country * gender,
anova_data_wide,
plottype = "line",
overlay.type = "box",
mean.label = TRUE
)
?plot2WayANOVA
Plot2WayANOVA(O ~ country * gender,
anova_data_wide,
plottype = "line",
overlay.type = "box",
mean.label = TRUE
)
# figures
library(CGPfunctions)
if(!require(CGPfunctions)){
install.packages("CPGfunctions")}
# figures
interaction.plot(anova_data_wide, country, gender,
fun = mean, type= c("b"),
xlab= "country" ,
ylab = "Openness",
main="Interaction Plot" )
# figures
anova_data_wide %>%
interaction.plot(O, country, gender,
fun = mean, type= c("b"),
xlab= "country" ,
ylab = "Openness",
main="Interaction Plot" )
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$O, country, gender,
fun = mean, type= c("b"),
xlab= "country" ,
ylab = "Openness",
main="Interaction Plot" )
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
filter(country %in% c("GB", "IN"), age >=18 & age <= 80) %>%   #Use ONLY Great Britain and India cases, and age between 18 and 80 years
mutate(country = as.factor(country)) %>%
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(age,country,gender, E, O)
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$O, country, gender,
fun = mean, type= c("b"),
xlab= "country" ,
ylab = "Openness",
main="Interaction Plot" )
# figures
anova_data_wide %>%
interaction.plot(country, gender,
fun = mean, type= c("b"),
xlab= "country" ,
ylab = "Openness",
main="Interaction Plot" )
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$country, anova_data_wide$gender, O
fun = mean, type= c("b"),
xlab= "country" ,
ylab = "Openness",
main="Interaction Plot" )
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$country, anova_data_wide$gender, O
fun = mean, type= c("b"),
xlab= "country",
ylab = "Openness",
main="Interaction Plot" )
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$country, anova_data_wide$gender, O
fun = mean, type= c("b"))
?interaction.plot
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$country, anova_data_wide$gender, O
fun = mean, type= l,
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$country, anova_data_wide$gender, O,
fun = mean, type= l,
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$country, anova_data_wide$gender, O,
fun = mean, type= "l",
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
filter(country %in% c("GB", "IN"), age >=18 & age <= 80) %>%   #Use ONLY Great Britain and India cases, and age between 18 and 80 years
mutate(country = as.factor(country)) %>%
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(age,country,gender, E, O)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
filter(country %in% c("GB", "IN"), age >=18 & age <= 80) %>%   #Use ONLY Great Britain and India cases, and age between 18 and 80 years
mutate(country = as.factor(country)) %>%
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(-age,country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(age,country,gender, E, O)
anova_data_wide = raw_data %>%
dplyr::select(-c(race,engnat,hand,source)) %>%  #retain only those columns required for the analysis
filter(country %in% c("GB", "IN"), age >=18 & age <= 80) %>%   #Use ONLY Great Britain and India cases, and age between 18 and 80 years
mutate(country = as.factor(country)) %>%
filter_if(is.numeric, all_vars((.) != 0)) %>%  #dropping all rows with missing values
mutate(gender = recode(gender, `1` = "Male", `2` = "Female", `3` = "Other")) %>%
filter(gender != "Other") %>% #retain only males and females
mutate(gender = as.factor(gender)) %>%
select(c(-age,country,gender,O1:O10, E1:E10)) %>%
rowwise() %>%
#score variables, r annoted are reverse scored items
mutate(E4r = (6-E4),
E6r = (6-E6),
E8r = (6-E8),
E10r = (6-E10),
O2r = (6-O2),
O4r = (6-O4)) %>%
mutate(E = sum(E1, E2, E3,E4r, E5,E6r, E7, E8r, E9, E10r),
O =sum(O1, O2r, O3, O4r, O5, O6, O7)) %>%
select(country,gender, E, O)
# figures
anova_data_wide %>%
interaction.plot(anova_data_wide$country, anova_data_wide$gender, O,
fun = mean, type= "l",
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
# figures
anova_plot <- anova_data_wide %>%
select(country,gender, O)
anova_plot %>%
interaction.plot(country, gender, O,
fun = mean, type= "l",
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
anova_plot %>%
interaction.plot(anova_plot$country, anova_plot$gender, O,
fun = mean, type= "l",
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
anova_plot %>%
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
fun = mean, type= "l",
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
anova_plot
anova_plot %>%
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O)
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O)
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O)
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
# fun = mean, type= "l",
xlab= "country",
ylab = "Openness",
main="Interaction Plot")
library(ggpubr)
ggline(anova_plot, x = "country", y = "O")
?ggline
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
# fun = mean, type= "l",
xlab= "Country",
ylab = "Openness",
main="Interaction Plot")
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
# fun = mean, type= "l",
xlab= "Country",
ylab = "Openness",
trace.label = "Gender"
main="Interaction Plot")
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
xlab= "Country",
ylab = "Openness",
trace.label = "Gender",
main="Interaction Plot")
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
xlab= "Country",
ylab = "Openness",
main="Interaction between Country and Gender on Openness",
trace.label = "Gender",)
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
xlab= "Country",
ylab = "Openness",
main="Interaction between Country and Gender on Openness",
trace.label = "Gender",
type = "b",
col=c("Great Britain", "India"))
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
xlab= "Country",
ylab = "Openness",
main="Interaction between Country and Gender on Openness",
trace.label = "Gender",
type = "b",
col=c("Great Britain", "India"))
interaction.plot(anova_plot$country, anova_plot$gender, anova_plot$O,
xlab= "Country",
ylab = "Openness",
main="Interaction between Country and Gender on Openness",
trace.label = "Gender",
type = "b",
col=c("red", "green"))
?ggplot
anova_plot %>%
ggplot(aes(x = "country", y = "O", color = gender)) +
geom_line(aes(group = gender)) +
geom(point)
anova_plot %>%
ggplot(aes(x = "country", y = "O", color = gender)) +
geom_line(aes(group = gender)) +
geom_point()
anova_plot %>%
ggplot(aes(x = country, color = gender, group = gender, y = O)) +
stat_summary(fun.y = mean, geom = "point") +
stat_summary(fun.y = mean, geom = "line")
anova_plot %>%
ggplot(aes(x = country, color = gender, group = gender, y = O)) +
stat_summary(fun.y = mean, geom = "point") +
stat_summary(fun.y = mean, geom = "line") +
xlab= "Country" +
ylab = "Openness" +
main="Interaction between Country and Gender on Openness" +
trace.label = "Gender"
anova_plot %>%
ggplot(aes(x = country, color = gender, group = gender, y = O)) +
stat_summary(fun.y = mean, geom = "point") +
stat_summary(fun.y = mean, geom = "line") +
xlab= "Country" +
ylab = "Openness"
anova_plot %>%
ggplot(aes(x = country, color = gender, group = gender, y = O)) +
stat_summary(fun.y = mean, geom = "point") +
stat_summary(fun.y = mean, geom = "line") +
labs(title = "Interaction of Country and Gender on Openness",
x = "Country",
y = "Openness to Experience")
ggplot(anova_data_wide, aes(x = country, y = O, color = gender)) +
geom_boxplot() +
theme_minimal() +
labs(title = "Comparison of Openness across Genders between The Great Britain and India",
x = "country",
y = "Openness to Experience",
fill = "Gender") +
scale_x_discrete(labels = c("Great Britain", "India"))
anova_plot %>%
ggplot(aes(x = country, color = gender, group = gender, y = O)) +
stat_summary(fun.y = mean, geom = "point") +
stat_summary(fun.y = mean, geom = "line") +
labs(title = "Interaction of Country and Gender on Openness",
x = "Country",
y = "Openness to Experience",
fill = "Gender") +
scale_x_discrete(labels = c("Great Britain", "India"))
anova_plot %>%
ggplot(aes(x = country, color = gender, group = gender, y = O)) +
stat_summary(fun.y = mean, geom = "point") +
stat_summary(fun.y = mean, geom = "line") +
labs(title = "Interaction of Country and Gender on Openness",
x = "Country",
y = "Openness to Experience",
group = "Gender") +
scale_x_discrete(labels = c("Great Britain", "India"))
ggplot(anova_data_wide, aes(x = country, y = O, color = gender)) +
geom_boxplot() +
theme_minimal() +
labs(title = "Comparison of Openness across Genders between The Great Britain and India",
x = "country",
y = "Openness to Experience")
